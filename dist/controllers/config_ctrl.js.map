{"version":3,"sources":["../../src/controllers/config_ctrl.js"],"names":["_","DefaultFlags","MeasurementStateFlags","OpenHistorianConfigCtrl","$scope","ctrl","current","jsonData","Included","undefined","Excluded","IncludeNormal","flags","merge","flagArray","map","Object","keys","a","key","order","Order","sort","b","flag","type","flagVarIncluded","flagVarExcluded","each","index","list","padDigits","dec2hex","number","toString","toUpperCase","digits","Array","Math","max","String","length","join","templateUrl"],"mappings":"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","file":"config_ctrl.js","sourcesContent":["//******************************************************************************************************\r\n//  config_ctrl.js - Gbtc\r\n//\r\n//  Copyright ï¿½ 2017, Grid Protection Alliance.  All Rights Reserved.\r\n//\r\n//  Licensed to the Grid Protection Alliance (GPA) under one or more contributor license agreements. See\r\n//  the NOTICE file distributed with this work for additional information regarding copyright ownership.\r\n//  The GPA licenses this file to you under the MIT License (MIT), the \"License\"; you may not use this\r\n//  file except in compliance with the License. You may obtain a copy of the License at:\r\n//\r\n//      http://opensource.org/licenses/MIT\r\n//\r\n//  Unless agreed to in writing, the subject software distributed under the License is distributed on an\r\n//  \"AS-IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. Refer to the\r\n//  License for the specific language governing permissions and limitations.\r\n//\r\n//  Code Modification History:\r\n//  ----------------------------------------------------------------------------------------------------\r\n//  10/30/2017 - Billy Ernest\r\n//       Generated original version of source code.\r\n//\r\n//******************************************************************************************************\r\n\r\nimport _ from \"lodash\";\r\nimport { DefaultFlags, MeasurementStateFlags } from './../js/constants.js'\r\n\r\nexport class OpenHistorianConfigCtrl{\r\n    constructor($scope) {\r\n\r\n    // #region Members\r\n        var ctrl = this;\r\n\r\n        ctrl.current.jsonData = ctrl.current.jsonData || {}\r\n        ctrl.current.jsonData.Included = (ctrl.current.jsonData.Included == undefined ? 0xFFFFFFF : ctrl.current.jsonData.Included);\r\n        ctrl.current.jsonData.Excluded = (ctrl.current.jsonData.Excluded == undefined ? 0x0000000 : ctrl.current.jsonData.Excluded);\r\n        ctrl.current.jsonData.IncludeNormal = (ctrl.current.jsonData.IncludeNormal == undefined ? true : ctrl.current.jsonData.IncludeNormal);\r\n\n\n        ctrl.current.jsonData.flags = (ctrl.current.jsonData.flags == undefined ? DefaultFlags : _.merge(DefaultFlags, ctrl.current.jsonData.flags));\r\n\r\n        ctrl.flagArray = _.map(Object.keys(ctrl.current.jsonData.flags), function (a) {\r\n            return { key: a, order: ctrl.current.jsonData.flags[a].Order };\r\n        }).sort(function (a, b) {\r\n            return a.order - b.order;\r\n        });\r\n\r\n    // #endregion\r\n\r\n\r\n    }\r\n\r\n    // #region Methods\r\n    calculateFlags(flag, type) {\r\n        var ctrl = this;\r\n\r\n        var flagVarIncluded = 0;\r\n        var flagVarExcluded = 0;\r\n\r\n        if (flag == 'Select All') {\r\n            _.each(Object.keys(ctrl.current.jsonData.flags), function (key, index, list) {\r\n                if (type == 'Included') {\r\n                    ctrl.current.jsonData.flags[key].Excluded = false;\r\n                    ctrl.current.jsonData.flags[key].Included = true;\r\n                }\r\n                else if (type == 'Excluded') {\r\n                    ctrl.current.jsonData.flags[key].Included = false;\r\n                    ctrl.current.jsonData.flags[key].Excluded = true;\r\n                }\r\n            });\r\n\r\n            if (type == 'Included') {\r\n                flagVarIncluded = 0xFFFFFFFF;\r\n                flagVarExcluded = 0x00000000;\r\n            }\r\n            else if (type == 'Excluded') {\r\n                flagVarExcluded = 0xFFFFFFFF;\r\n                flagVarIncluded = 0x00000000;\r\n            }\r\n\r\n        }\r\n        else {\r\n            ctrl.current.jsonData.flags['Select All'].Included = false;\r\n            ctrl.current.jsonData.flags['Select All'].Excluded = false;\r\n\r\n            _.each(Object.keys(ctrl.current.jsonData.flags), function (key, index, list) {\r\n                if (key == 'Select All') return;\r\n\r\n                if (type == 'Included') {\r\n                    ctrl.current.jsonData.flags[key].Excluded = !ctrl.current.jsonData.flags[key].Included\r\n                }\r\n                else if (type == 'Excluded') {\r\n                    ctrl.current.jsonData.flags[key].Included = !ctrl.current.jsonData.flags[key].Excluded\r\n                }\r\n\r\n\r\n                flagVarIncluded = flagVarIncluded | (ctrl.current.jsonData.flags[key].Included ? MeasurementStateFlags[key] : 0);\r\n                flagVarExcluded = flagVarExcluded | (ctrl.current.jsonData.flags[key].Excluded ? MeasurementStateFlags[key] : 0);\r\n            });\r\n        }\r\n\r\n        ctrl.current.jsonData.Included = '0x' + ctrl.padDigits(this.dec2hex(flagVarIncluded), 8);\r\n        ctrl.current.jsonData.Excluded = '0x' + ctrl.padDigits(this.dec2hex(flagVarExcluded), 8);\r\n        ctrl.current.jsonData.IncludeNormal = ctrl.current.jsonData.flags['Normal'].Included;\r\n\r\n    }\r\n\r\n    dec2hex(number) {\r\n        if (number < 0) {\r\n            number = 0xFFFFFFFF + number + 1;\r\n        }\r\n\r\n        return number.toString(16).toUpperCase();\r\n    }\r\n\r\n    padDigits(number, digits) {\r\n        return Array(Math.max(digits - String(number).length + 1, 0)).join(0) + number;\r\n    }\r\n\r\n    // #endregion\r\n}\r\nOpenHistorianConfigCtrl.templateUrl = 'partial/config.html';\r\n\n"]}